(function(){var g=window.fw;if(g){g.utils.a=function(a,b){for(var c=a,d=RegExp("{:(.*?)}","g"),e=null;null!=(e=d.exec(a));)"undefined"!=typeof b[e[1]]?(c=c.replace(e[0],b[e[1]]),delete b[e[1]]):c=c.replace(e[0],"");return c};var l=function(a,b,c){return function(d,e,f){d=d||this.attr();var h={},k;for(k in d)h[k]=d[k];d={type:a.toUpperCase(),url:g.utils.a(b,h),dataType:"json",cache:!1,data:h};"function"==typeof e&&(d.success=function(a){"function"==typeof c&&(a=c.call(this,a));e.call(this,a)});"function"==
typeof f&&(d.error=f);jQuery.ajax(d)}},m=function(a,b,c,d){b=b.match("^(GET|POST|PUT|DELETE)[\\s]+(.*)$");2<b.length&&(a[c]=l(b[1],b[2],function(a){return d.call(this,a)}))};g.Model=function(a){a=a||{};var b={save:function(a){"undefined"!=typeof this.__theNew?this.create(this.attr(),a):this.update(this.attr(),a)}},c={},d=g.Map.extend(b,{});"undefined"!=typeof a.findAll&&m(c,a.findAll,"findAll",function(a){var b=[];if("undefined"!=typeof a.data)for(var c in a.data){var e=new d(a.data[c]);b.push(e)}return b});
"undefined"!=typeof a.findOne&&m(c,a.findOne,"findOne",function(a){var b=null;a&&(b=new d(a));return b});for(var e in a){var f=a[e].match("^(GET|POST|PUT|DELETE)[\\s]+(.*)$");if(2<f.length)switch(e.toLowerCase()){case "create":var h=l(f[1],f[2]);b.create=function(a,b){h.call(this,null,a,b)};break;case "update":var k=l(f[1],f[2]);b.update=function(a,b){k.call(this,null,a,b)};break;case "destroy":var n=l(f[1],f[2]);b.destroy=function(a,b){this.id&&n.call(this,{id:this.id},a,b)}}}return g.Map.extend(b,
c,{init:function(){"function"==typeof a.init&&(a.init.call(this),delete a.init);this.__theNew=!0}})}}else console.error("you must first load jfw.core")})();
