(function(window){if(!window.history)return;var document=window.document;var documentElement=document.documentElement;var Object=window["Object"];var JSON=window["JSON"];var windowLocation=window.location;var windowHistory=window.history;var historyObject=windowHistory;var historyPushState=windowHistory.pushState;var historyReplaceState=windowHistory.replaceState;var isSupportHistoryAPI=!!historyPushState;var isSupportStateObjectInHistory="state"in windowHistory;var defineProperty=Object.defineProperty;
var locationObject=redefineProperty({},"t")?{}:document.createElement("a");var eventNamePrefix="";var addEventListenerName=window.addEventListener?"addEventListener":(eventNamePrefix="on")&&"attachEvent";var removeEventListenerName=window.removeEventListener?"removeEventListener":"detachEvent";var dispatchEventName=window.dispatchEvent?"dispatchEvent":"fireEvent";var addEvent=window[addEventListenerName];var removeEvent=window[removeEventListenerName];var dispatch=window[dispatchEventName];var settings=
{"basepath":"/","redirect":0,"type":"/"};var sessionStorageKey="__historyAPI__";var anchorElement=document.createElement("a");var lastURL=windowLocation.href;var checkUrlForPopState="";var isFireInitialState=false;var stateStorage={};var eventsList={};var lastTitle=document.title;var eventsDescriptors={"onhashchange":null,"onpopstate":null};var fastFixChrome=function(method,args){var isNeedFix=window.history!==windowHistory;if(isNeedFix)window.history=windowHistory;method.apply(windowHistory,args);
if(isNeedFix)window.history=historyObject};var historyDescriptors={"redirect":function(type,basepath){settings["basepath"]=basepath=basepath==null?settings["basepath"]:basepath;settings["type"]=type=type==null?settings["type"]:type;if(window.top==window.self){var relative=parseURL(null,false,true)._relative;var path=windowLocation.pathname+windowLocation.search;if(isSupportHistoryAPI){path=path.replace(/([^\/])$/,"$1/");if(relative!=basepath&&(new RegExp("^"+basepath+"$","i")).test(path))windowLocation.replace(relative)}else if(path!=
basepath){path=path.replace(/([^\/])\?/,"$1/?");if((new RegExp("^"+basepath,"i")).test(path))windowLocation.replace(basepath+"#"+path.replace(new RegExp("^"+basepath,"i"),type)+windowLocation.hash)}}},pushState:function(state,title,url){var t=document.title;if(lastTitle!=null)document.title=lastTitle;historyPushState&&fastFixChrome(historyPushState,arguments);changeState(state,url);document.title=t;lastTitle=title},replaceState:function(state,title,url){var t=document.title;if(lastTitle!=null)document.title=
lastTitle;delete stateStorage[windowLocation.href];historyReplaceState&&fastFixChrome(historyReplaceState,arguments);changeState(state,url,true);document.title=t;lastTitle=title},"location":{set:function(value){window.location=value},get:function(){return isSupportHistoryAPI?windowLocation:locationObject}},"state":{get:function(){return stateStorage[windowLocation.href]||null}}};var locationDescriptors={assign:function(url){if((""+url).indexOf("#")===0)changeState(null,url);else windowLocation.assign(url)},
reload:function(){windowLocation.reload()},replace:function(url){if((""+url).indexOf("#")===0)changeState(null,url,true);else windowLocation.replace(url)},toString:function(){return this.href},"href":{get:function(){return parseURL()._href}},"protocol":null,"host":null,"hostname":null,"port":null,"pathname":{get:function(){return parseURL()._pathname}},"search":{get:function(){return parseURL()._search}},"hash":{set:function(value){changeState(null,(""+value).replace(/^(#|)/,"#"),false,lastURL)},
get:function(){return parseURL()._hash}}};function emptyFunction(){}function parseURL(href,isWindowLocation,isNotAPI){var re=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(href!=null&&(href!==""&&!isWindowLocation)){var current=parseURL(),_pathname=current._pathname,_protocol=current._protocol;href=""+href;href=/^(?:[\w0-9]+\:)?\/\//.test(href)?href.indexOf("/")===0?_protocol+href:href:_protocol+"//"+current._host+(href.indexOf("/")===0?href:
href.indexOf("?")===0?_pathname+href:href.indexOf("#")===0?_pathname+current._search+href:_pathname.replace(/[^\/]+$/g,"")+href)}else{href=isWindowLocation?href:windowLocation.href;if(!isSupportHistoryAPI||isNotAPI){href=href.replace(/^[^#]*/,"")||"#";href=windowLocation.protocol+"//"+windowLocation.host+settings["basepath"]+href.replace(new RegExp("^#[/]?(?:"+settings["type"]+")?"),"")}}anchorElement.href=href;var result=re.exec(anchorElement.href);var host=result[2]+(result[3]?":"+result[3]:"");
var pathname=result[4]||"/";var search=result[5]||"";var hash=result[6]==="#"?"":result[6]||"";var relative=pathname+search+hash;var nohash=pathname.replace(new RegExp("^"+settings["basepath"],"i"),settings["type"])+search;return{_href:result[1]+"//"+host+relative,_protocol:result[1],_host:host,_hostname:result[2],_port:result[3]||"",_pathname:pathname,_search:search,_hash:hash,_relative:relative,_nohash:nohash,_special:nohash+hash}}function storageInitialize(){var sessionStorage;try{sessionStorage=
window["sessionStorage"];sessionStorage.setItem(sessionStorageKey+"t","1");sessionStorage.removeItem(sessionStorageKey+"t")}catch(_e_){sessionStorage={getItem:function(key){var cookie=document.cookie.split(key+"=");return cookie.length>1&&cookie.pop().split(";").shift()||"null"},setItem:function(key,value){var state={};if(state[windowLocation.href]=historyObject.state)document.cookie=key+"="+JSON.stringify(state)}}}try{stateStorage=JSON.parse(sessionStorage.getItem(sessionStorageKey))||{}}catch(_e_){stateStorage=
{}}addEvent(eventNamePrefix+"unload",function(){sessionStorage.setItem(sessionStorageKey,JSON.stringify(stateStorage))},false)}function redefineProperty(object,prop,descriptor,onWrapped){descriptor=descriptor||{set:emptyFunction};var isDefinedSetter=!descriptor.set;var isDefinedGetter=!descriptor.get;var test={configurable:true,set:function(){isDefinedSetter=1},get:function(){isDefinedGetter=1}};try{defineProperty(object,prop,test);object[prop]=object[prop];defineProperty(object,prop,descriptor)}catch(_e_){}if(!isDefinedSetter||
!isDefinedGetter){if(object.__defineGetter__){object.__defineGetter__(prop,test.get);object.__defineSetter__(prop,test.set);object[prop]=object[prop];descriptor.get&&object.__defineGetter__(prop,descriptor.get);descriptor.set&&object.__defineSetter__(prop,descriptor.set)}if((!isDefinedSetter||!isDefinedGetter)&&object===window){try{var originalValue=object[prop];object[prop]=null}catch(_e_){}if("execScript"in window)window["execScript"]("Public "+prop,"VBScript");else try{defineProperty(object,prop,
{value:emptyFunction})}catch(_e_){}object[prop]=originalValue}else if(!isDefinedSetter||!isDefinedGetter)try{try{var temp=Object.create(object);defineProperty(Object.getPrototypeOf(temp)===object?temp:object,prop,descriptor);for(var key in object)if(typeof object[key]==="function")temp[key]=object[key].bind(object);try{onWrapped.call(temp,temp,object)}catch(_e_){}object=temp}catch(_e_){defineProperty(object.constructor.prototype,prop,descriptor)}}catch(_e_){return false}}return object}function prepareDescriptorsForObject(object,
prop,descriptor){descriptor=descriptor||{};object=object===locationDescriptors?windowLocation:object;descriptor.set=descriptor.set||function(value){object[prop]=value};descriptor.get=descriptor.get||function(){return object[prop]};return descriptor}function addEventListener(event,listener,capture){if(event in eventsList)eventsList[event].push(listener);else if(arguments.length>3)addEvent(event,listener,capture,arguments[3]);else addEvent(event,listener,capture)}function removeEventListener(event,
listener,capture){var list=eventsList[event];if(list)for(var i=list.length;--i;){if(list[i]===listener){list.splice(i,1);break}}else removeEvent(event,listener,capture)}function dispatchEvent(event,eventObject){var eventType=(""+(typeof event==="string"?event:event.type)).replace(/^on/,"");var list=eventsList[eventType];if(list){eventObject=typeof event==="string"?eventObject:event;if(eventObject.target==null)for(var props=["target","currentTarget","srcElement","type"];event=props.pop();)eventObject=
redefineProperty(eventObject,event,{get:event==="type"?function(){return eventType}:function(){return window}});((eventType==="popstate"?window.onpopstate:window.onhashchange)||emptyFunction).call(window,eventObject);for(var i=0,len=list.length;i<len;i++)list[i].call(window,eventObject);return true}else return dispatch(event,eventObject)}function firePopState(){var o=document.createEvent?document.createEvent("Event"):document.createEventObject();if(o.initEvent)o.initEvent("popstate",false,false);
else o.type="popstate";o.state=historyObject.state;dispatchEvent(o)}function fireInitialState(){if(isFireInitialState){isFireInitialState=false;firePopState()}}function changeState(state,url,replace,lastURLValue){if(!isSupportHistoryAPI){var urlObject=parseURL(url);if(urlObject._relative!==parseURL()._relative){lastURL=lastURLValue;if(replace)windowLocation.replace("#"+urlObject._special);else windowLocation.hash=urlObject._special}}if(!isSupportStateObjectInHistory&&state)stateStorage[windowLocation.href]=
state;isFireInitialState=false}function onHashChange(event){if(lastURL){if(checkUrlForPopState!==windowLocation.href)firePopState();event=event||window.event;var oldURLObject=parseURL(lastURL,true);var newURLObject=parseURL();if(!event.oldURL){event.oldURL=oldURLObject._href;event.newURL=newURLObject._href}if(oldURLObject._hash!==newURLObject._hash)dispatchEvent(event)}lastURL=windowLocation.href}function onLoad(noScroll){setTimeout(function(){addEvent("popstate",function(e){checkUrlForPopState=windowLocation.href;
if(!isSupportStateObjectInHistory)e=redefineProperty(e,"state",{get:function(){return historyObject.state}});dispatchEvent(e)},false)},0);if(!isSupportHistoryAPI&&(noScroll!==true&&historyObject.location)){scrollToAnchorId(historyObject.location.hash);fireInitialState()}}function anchorTarget(target){while(target){if(target.nodeName==="A")return target;target=target.parentNode}}function onAnchorClick(e){var event=e||window.event;var target=anchorTarget(event.target||event.srcElement);var defaultPrevented=
"defaultPrevented"in event?event["defaultPrevented"]:event.returnValue===false;if(target&&(target.nodeName==="A"&&!defaultPrevented)){var current=parseURL();var expect=parseURL(target.getAttribute("href",2));var isEqualBaseURL=current._href.split("#").shift()===expect._href.split("#").shift();if(isEqualBaseURL&&expect._hash){if(current._hash!==expect._hash)historyObject.location.hash=expect._hash;scrollToAnchorId(expect._hash);if(event.preventDefault)event.preventDefault();else event.returnValue=
false}}}function scrollToAnchorId(hash){var target=document.getElementById(hash=(hash||"").replace(/^#/,""));if(target&&(target.id===hash&&target.nodeName==="A")){var rect=target.getBoundingClientRect();window.scrollTo(documentElement.scrollLeft||0,rect.top+(documentElement.scrollTop||0)-(documentElement.clientTop||0))}}function initialize(){var scripts=document.getElementsByTagName("script");var src=(scripts[scripts.length-1]||{}).src||"";var arg=src.indexOf("?")!==-1?src.split("?").pop():"";arg.replace(/(\w+)(?:=([^&]*))?/g,
function(a,key,value){settings[key]=(value||(key==="basepath"?"/":"")).replace(/^(0|false)$/,"")});ie6DriverStart();addEvent(eventNamePrefix+"hashchange",onHashChange,false);var data=[locationDescriptors,locationObject,eventsDescriptors,window,historyDescriptors,historyObject];if(isSupportStateObjectInHistory)delete historyDescriptors["state"];for(var i=0;i<data.length;i+=2)for(var prop in data[i])if(data[i].hasOwnProperty(prop))if(typeof data[i][prop]==="function")data[i+1][prop]=data[i][prop];else{var descriptor=
prepareDescriptorsForObject(data[i],prop,data[i][prop]);if(!redefineProperty(data[i+1],prop,descriptor,function(n,o){if(o===historyObject)window.history=historyObject=data[i+1]=n})){removeEvent(eventNamePrefix+"hashchange",onHashChange,false);return false}if(data[i+1]===window)eventsList[prop]=eventsList[prop.substr(2)]=[]}if(settings["redirect"])historyObject["redirect"]();if(!isSupportStateObjectInHistory&&JSON)storageInitialize();if(!isSupportHistoryAPI)document[addEventListenerName](eventNamePrefix+
"click",onAnchorClick,false);if(document.readyState==="complete")onLoad(true);else{if(!isSupportHistoryAPI&&parseURL()._relative!==settings["basepath"])isFireInitialState=true;addEvent(eventNamePrefix+"load",onLoad,false)}return true}if(!initialize())return;historyObject["emulate"]=!isSupportHistoryAPI;window[addEventListenerName]=addEventListener;window[removeEventListenerName]=removeEventListener;window[dispatchEventName]=dispatchEvent;function ie6DriverStart(){function createVBObjects(object){var properties=
[];var className="VBHistoryClass"+(new Date).getTime()+msie++;var staticClassParts=["Class "+className];for(var prop in object)if(object.hasOwnProperty(prop)){var value=object[prop];if(value&&(value.get||value.set)){if(value.get)staticClassParts.push("Public "+(prop==="_"?"Default ":"")+"Property Get ["+prop+"]","Call VBCVal([(accessors)].["+prop+"].get.call(me),["+prop+"])","End Property");if(value.set)staticClassParts.push("Public Property Let ["+prop+"](val)",value="Call [(accessors)].["+prop+
"].set.call(me,val)\nEnd Property","Public Property Set ["+prop+"](val)",value)}else{properties.push(prop);staticClassParts.push("Public ["+prop+"]")}}staticClassParts.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+className+"FactoryJS()","End Sub","End Class","Function "+className+"Factory()","Set "+className+"Factory=New "+className,"End Function");window["execScript"](staticClassParts.join("\n"),"VBScript");window[className+"FactoryJS"]=function(){return object};
var result=window[className+"Factory"]();for(var i=0;i<properties.length;i++)result[properties[i]]=object[properties[i]];return result}function quote(string){var escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return escapable.test(string)?'"'+string.replace(escapable,function(a){return a in meta?meta[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+string+'"'}var msie=window["eval"]&&eval("/*@cc_on 1;@*/");if(!msie||+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1]>7)return;var originalChangeState=changeState;var originalRedefineProperty=redefineProperty;var currentHref=parseURL()._href;var iFrame=document.createElement("iframe");iFrame.src="javascript:true;";iFrame=documentElement.firstChild.appendChild(iFrame).contentWindow;window["execScript"]("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");locationObject={"_":{get:locationDescriptors.toString}};historyObject={"back":windowHistory.back,"forward":windowHistory.forward,"go":windowHistory.go,"emulate":null,"_":{get:function(){return"[object History]"}}};JSON={"parse":function(value){try{return(new Function("","return "+value))()}catch(_e_){return null}},"stringify":function(value){var n=(typeof value).charCodeAt(2);return n===114?quote(value):n===109?isFinite(value)?String(value):"null":n===111||n===108?String(value):n===106?
!value?"null":function(isArray){var out=isArray?"[":"{";if(isArray)for(var i=0;i<value.length;i++)out+=(i==0?"":",")+JSON.stringify(value[i]);else for(var k in value)if(value.hasOwnProperty(k))out+=(out.length==1?"":",")+quote(k)+":"+JSON.stringify(value[k]);return out+(isArray?"]":"}")}(Object.prototype.toString.call(value)==="[object Array]"):"void 0"}};changeState=function(state,url,replace,lastURLValue,lfirst){var iFrameDocument=iFrame.document;var urlObject=parseURL(url);isFireInitialState=false;
if(urlObject._relative===parseURL()._relative&&!lfirst){if(state)stateStorage[windowLocation.href]=state;return}lastURL=lastURLValue;if(replace)if(iFrame["lfirst"]){history.back();changeState(state,urlObject._href,0,lastURLValue,1)}else windowLocation.replace("#"+urlObject._special);else if(urlObject._href!=currentHref||lfirst){if(!iFrame["lfirst"]){iFrame["lfirst"]=1;changeState(state,currentHref,0,lastURLValue,1)}iFrameDocument.open();iFrameDocument.write('<script>lfirst=1;parent.location.hash="'+
urlObject._special.replace(/"/g,'\\"')+'";\x3c/script>');iFrameDocument.close()}if(!lfirst&&state)stateStorage[windowLocation.href]=state};redefineProperty=function(object,prop,descriptor,onWrapped){if(!originalRedefineProperty.apply(this,arguments))if(object===locationObject)locationObject[prop]=descriptor;else if(object===historyObject){historyObject[prop]=descriptor;if(prop==="state"){locationObject=createVBObjects(locationObject);window.history=historyObject=createVBObjects(historyObject)}}else object[prop]=
descriptor.get&&descriptor.get();return object};var interval=setInterval(function(){var href=parseURL()._href;if(href!=currentHref){var e=document.createEventObject();e.oldURL=currentHref;e.newURL=currentHref=href;e.type="hashchange";onHashChange(e)}},100);window["JSON"]=JSON}})(window);
